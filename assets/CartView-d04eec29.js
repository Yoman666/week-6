import{_ as $,o as d,c as r,d as g,a as t,F as _,e as m,h as f,t as c,i as y,v as C}from"./index-20c1514c.js";const{VITE_API:i,VITE_PATH:u}={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"yoyo123456",BASE_URL:"/week-6/",MODE:"production",DEV:!1,PROD:!0},I={data(){return{loadingStatus:{loadingItem:""},cart:{}}},methods:{getCarts(){const e=`${i}/api/${u}/cart`;this.$http.get(e).then(s=>{console.log("取得購物車表",s.data),this.cart=s.data.data})},updateCarts(e){this.loadingStatus.loadingItem=e.id;const s={product_id:e.product.id,qty:e.qty},a=`${i}/api/${u}/cart/${e.id}`;this.$http.put(a,{data:s}).then(h=>{this.loadingStatus.loadingItem="",console.log("更新購物車",h.data),this.getCarts()}).catch(h=>{alert(h.response.data.message),this.loadingStatus.loadingItem=""})},deleteitem(e){this.loadingStatus.loadingItem=e.id;const s=`${i}/api/${u}/cart/${e.id}`;this.$http.delete(s).then(a=>{this.loadingStatus.loadingItem="",console.log("刪除購物車",a.data),this.getCarts()})},deleteAllItem(){const e=`${i}/api/${u}/carts`;this.$http.delete(e).then(s=>{console.log("刪除全部購物車",s.data),this.getCarts()})},createOrder(){const e=`${i}/api/${u}/order`,s=this.form;this.$http.post(e,{data:s}).then(a=>{alert(a.data.message),this.$refs.form.resetForm(),this.getCarts(),console.log("送出訂單",a),console.log("ref",this.$refs.form)})}},mounted(){this.getCarts()}},b={class:"table align-middle"},x=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"150px"}},"數量/單位"),t("th",null,"單價")])],-1),v=["onClick"],V={key:0,class:"fas fa-spinner fa-pulse"},k={class:"input-group input-group-sm"},S={class:"input-group mb-3"},E=["onUpdate:modelValue","onChange"],A=["value"],T={class:"text-end"},D=t("td",{colspan:"3",class:"text-end"},"總計",-1),P={class:"text-end"},q=t("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),w={class:"text-end text-success"};function B(e,s,a,h,l,p){return d(),r(_,null,[g(" 這是購物車頁面 "),t("table",b,[x,t("tbody",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:s[0]||(s[0]=o=>p.deleteAllItem())}," 清空購物車 "),l.cart.carts?(d(!0),r(_,{key:0},m(l.cart.carts,o=>(d(),r("tr",{key:o.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:n=>p.deleteitem(o)},[l.loadingStatus.loadingItem===o.id?(d(),r("i",V)):f("",!0),g(" x ")],8,v)]),t("td",null,c(o.product.title),1),t("td",null,[t("div",k,[t("div",S,[y(t("select",{name:"",id:"",class:"form-control","onUpdate:modelValue":n=>o.qty=n,onChange:n=>p.updateCarts(o)},[(d(),r(_,null,m(20,n=>t("option",{value:n,key:n+"123"},c(n),9,A)),64))],40,E),[[C,o.qty]])])])]),t("td",T,c(o.total),1)]))),128)):f("",!0)]),t("tfoot",null,[t("tr",null,[D,t("td",P,c(l.cart.total),1)]),t("tr",null,[q,t("td",w,c(l.cart.final_total),1)])])])],64)}const N=$(I,[["render",B]]);export{N as default};
