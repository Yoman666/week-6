import{_ as x,r as C,o as a,c,a as t,F as u,g,h as y,t as i,b as k,w as I,e as V,i as m,v,d as b}from"./index-98988ecf.js";const{VITE_API:_,VITE_PATH:h}={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"yoyo123456",BASE_URL:"/week-6/",MODE:"production",DEV:!1,PROD:!0},$={data(){return{loadingStatus:{loadingItem:""},cart:{}}},methods:{getCarts(){const l=`${_}/api/${h}/cart`;this.$http.get(l).then(s=>{console.log("取得購物車表",s.data),this.cart=s.data.data})},updateCarts(l){this.loadingStatus.loadingItem=l.id;const s={product_id:l.product.id,qty:l.qty},d=`${_}/api/${h}/cart/${l.id}`;this.$http.put(d,{data:s}).then(p=>{this.loadingStatus.loadingItem="",console.log("更新購物車",p.data),this.getCarts()}).catch(p=>{alert(p.response.data.message),this.loadingStatus.loadingItem=""})},deleteitem(l){this.loadingStatus.loadingItem=l.id;const s=`${_}/api/${h}/cart/${l.id}`;this.$http.delete(s).then(d=>{this.loadingStatus.loadingItem="",console.log("刪除購物車",d.data),this.getCarts()})},deleteAllItem(){const l=`${_}/api/${h}/carts`;this.$http.delete(l).then(s=>{console.log("刪除全部購物車",s.data),this.getCarts()})},createOrder(){const l=`${_}/api/${h}/order`,s=this.form;this.$http.post(l,{data:s}).then(d=>{alert(d.data.message),this.$refs.form.resetForm(),this.getCarts(),console.log("送出訂單",d),console.log("ref",this.$refs.form)})}},mounted(){this.getCarts()}},w=V('<section class="cart-section01"><div class="container"><ul class="row" style="display:flex;justify-content:space-around;"><li class="col-2 cart-lable cart-lable-active lable-text">購物車清單</li><li class="col-2 cart-lable lable-text">填寫資料</li><li class="col-2 cart-lable lable-text">確認訂單</li><li class="col-2 cart-lable lable-text">完成訂單</li></ul></div></section>',1),S={class:"products-section01"},T={class:"container d-flex flex-column align-items-center"},A=t("h3",{class:"my-2 text-title"},"購物車清單",-1),E={class:"col-2"},N={href:""},q=["src"],D={class:"col-10 cartlist-center-out"},U={class:"row cartlist-center"},O={class:"col-4"},P={class:"text-title"},B={class:"input-group my-3 bg-light rounded col-2",style:{width:"15%"}},F=["onUpdate:modelValue","onChange"],H=["value"],L={class:"col-5"},M={class:"text-title text-center"},R={class:"col-1"},j=["onClick"],G={key:0,class:"fas fa-spinner fa-pulse"},z={class:"container"},J=t("div",{style:{border:"10px solid #F8CA6D",width:"100%"},class:"my-4"},null,-1),K={style:{float:"right"}},Q=t("span",{class:"text-container"},"小計",-1),W={class:"product-price my-4"},X={class:"container"},Y={class:"table align-middle"},Z=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"150px"}},"數量/單位"),t("th",null,"單價")])],-1),tt=["onClick"],et={key:0,class:"fas fa-spinner fa-pulse"},st={class:"input-group input-group-sm"},ot={class:"input-group mb-3"},lt=["onUpdate:modelValue","onChange"],nt=["value"],at={class:"text-end"},ct=t("td",{colspan:"3",class:"text-end"},"總計",-1),it={class:"text-end"},dt=t("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),rt={class:"text-end text-success"};function ut(l,s,d,p,n,r){const f=C("router-link");return a(),c(u,null,[w,t("section",S,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:s[0]||(s[0]=e=>r.deleteAllItem())}," 清空購物車 "),t("div",T,[A,n.cart.carts?(a(!0),c(u,{key:0},g(n.cart.carts,e=>(a(),c("div",{class:"row cartliststyle my-3",key:e.id,style:{width:"100%"}},[t("div",E,[t("a",N,[t("img",{src:e.product.imageUrl,alt:""},null,8,q)])]),t("div",D,[t("div",U,[t("div",O,[t("h2",P,i(e.product.title),1)]),t("div",B,[m(t("select",{name:"",id:"",class:"form-control","onUpdate:modelValue":o=>e.qty=o,onChange:o=>r.updateCarts(e)},[(a(),c(u,null,g(20,o=>t("option",{value:o,key:o+"123"},i(o),9,H)),64))],40,F),[[v,e.qty]])]),t("div",L,[t("h2",M,"NT$ "+i(e.total),1)]),t("div",R,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:o=>r.deleteitem(e)},[n.loadingStatus.loadingItem===e.id?(a(),c("i",G)):y("",!0),b("x ")],8,j)])])])]))),128)):y("",!0)]),t("div",z,[J,t("div",K,[Q,t("p",W,"NT$"+i(n.cart.final_total),1)])])]),t("section",null,[t("div",X,[k(f,{to:"/cart2",class:"btn-style1 btn-color1 text-center my-4 d-inline-block",style:{float:"right"}},{default:I(()=>[b("GO TO 填寫資料")]),_:1})])]),t("table",Y,[Z,t("tbody",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:s[1]||(s[1]=e=>r.deleteAllItem())}," 清空購物車 "),n.cart.carts?(a(!0),c(u,{key:0},g(n.cart.carts,e=>(a(),c("tr",{key:e.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:o=>r.deleteitem(e)},[n.loadingStatus.loadingItem===e.id?(a(),c("i",et)):y("",!0),b(" x ")],8,tt)]),t("td",null,i(e.product.title),1),t("td",null,[t("div",st,[t("div",ot,[m(t("select",{name:"",id:"",class:"form-control","onUpdate:modelValue":o=>e.qty=o,onChange:o=>r.updateCarts(e)},[(a(),c(u,null,g(20,o=>t("option",{value:o,key:o+"123"},i(o),9,nt)),64))],40,lt),[[v,e.qty]])])])]),t("td",at,i(e.total),1)]))),128)):y("",!0)]),t("tfoot",null,[t("tr",null,[ct,t("td",it,i(n.cart.total),1)]),t("tr",null,[dt,t("td",rt,i(n.cart.final_total),1)])])])],64)}const ht=x($,[["render",ut]]);export{ht as default};
